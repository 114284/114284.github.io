<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>è¨˜æ†¶ç¿»ç‰ŒéŠæˆ²</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f5f5f5; text-align:center; }
    h1 { margin-top:20px; }
    #controls { margin: 10px; }
    .board {
      display: grid;
      grid-template-columns: repeat(4, 100px);
      grid-gap: 10px;
      justify-content: center;
      margin: 20px auto;
    }
    .card {
      width: 100px;
      height: 120px;
      background: #444;
      color: transparent;
      font-size: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      border-radius: 8px;
      user-select: none;
    }
    .card.open {
      background: #fff;
      color: #000;
      cursor: default;
    }
    .card.taken {
      visibility: hidden;
    }
    #status, #score { margin-top:10px; font-size:18px; }
  </style>
</head>
<body>
  <h1>è¨˜æ†¶ç¿»ç‰ŒéŠæˆ²</h1>
  <div id="controls">
    <button onclick="startGame('single')">å–®äººæ¨¡å¼</button>
    <button onclick="startGame('double')">é›™äººæ¨¡å¼</button>
  </div>

  <div id="status">è«‹é¸æ“‡æ¨¡å¼</div>
  <div id="score"></div>
  <div class="board" id="board"></div>

  <script>
    const animals = ['ğŸ¶','ğŸ±','ğŸ¼','ğŸ¦Š','ğŸ¸','ğŸµ','ğŸ¦','ğŸ·'];
    let cards = [];
    let opened = [];
    let currentPlayer = 1;
    let scores = {1:0, 2:0};
    let playerNames = {1:'ç©å®¶', 2:'ç©å®¶2'};
    let mode = 'single';
    let lock = false;

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    function startGame(selectedMode) {
      if (selectedMode === 'single') {
        const name1 = prompt('è«‹è¼¸å…¥ç©å®¶åç¨±ï¼š', 'ç©å®¶');
        playerNames[1] = name1 && name1.trim() !== '' ? name1 : 'ç©å®¶';
        playerNames[2] = 'é›»è…¦';
      } else {
        const name1 = prompt('è«‹è¼¸å…¥ç©å®¶1åç¨±ï¼š', 'ç©å®¶1');
        const name2 = prompt('è«‹è¼¸å…¥ç©å®¶2åç¨±ï¼š', 'ç©å®¶2');
        playerNames[1] = name1 && name1.trim() !== '' ? name1 : 'ç©å®¶1';
        playerNames[2] = name2 && name2.trim() !== '' ? name2 : 'ç©å®¶2';
      }

      mode = selectedMode;
      currentPlayer = 1;
      scores = {1:0, 2:0};
      opened = [];
      lock = false;

      cards = shuffle([...animals, ...animals]);
      const board = document.getElementById('board');
      board.innerHTML = '';

      cards.forEach((animal, index) => {
        const card = document.createElement('div');
        card.className = 'card';
        card.dataset.animal = animal;
        card.dataset.index = index;
        card.innerText = animal;
        card.onclick = () => flip(card);
        board.appendChild(card);
      });

      updateStatus();
      updateScore();
    }

    function flip(card) {
      if (lock || card.classList.contains('open') || card.classList.contains('taken')) return;

      card.classList.add('open');
      opened.push(card);

      if (opened.length === 2) {
        lock = true;
        setTimeout(checkMatch, 800);
      }
    }

    function checkMatch() {
      const [c1, c2] = opened;
      if (c1.dataset.animal === c2.dataset.animal) {
        c1.classList.add('taken');
        c2.classList.add('taken');
        scores[currentPlayer]++;
        opened = [];
        lock = false;
        updateScore();
        checkGameOver();
      } else {
        c1.classList.remove('open');
        c2.classList.remove('open');
        opened = [];
        switchPlayer();
      }
    }

    function switchPlayer() {
      currentPlayer = currentPlayer === 1 ? 2 : 1;
      updateStatus();
      lock = false;

      if (mode === 'single' && currentPlayer === 2) {
        setTimeout(computerTurn, 800);
      }
    }

    function computerTurn() {
      if (lock) return;
      const available = [...document.querySelectorAll('.card:not(.open):not(.taken)')];
      if (available.length < 2) {
        switchPlayer();
        return;
      }

      lock = true;
      const c1 = available[Math.floor(Math.random() * available.length)];
      c1.classList.add('open');
      opened = [c1];

      setTimeout(() => {
        const remaining = available.filter(c => c !== c1);
        const c2 = remaining[Math.floor(Math.random() * remaining.length)];
        c2.classList.add('open');
        opened.push(c2);

        setTimeout(() => {
          if (c1.dataset.animal === c2.dataset.animal) {
            c1.classList.add('taken');
            c2.classList.add('taken');
            scores[2]++;
            opened = [];
            updateScore();
            checkGameOver();
            lock = false;
            setTimeout(computerTurn, 800); // ç¹¼çºŒæŠ½
          } else {
            c1.classList.remove('open');
            c2.classList.remove('open');
            opened = [];
            lock = false;
            switchPlayer(); // æ›ç©å®¶
          }
        }, 800);
      }, 600);
    }, 600);
    }

    function updateStatus() {
      const playerName = playerNames[currentPlayer];
      document.getElementById('status').innerText = `ç›®å‰å›åˆï¼š${playerName}`;
    }

    function updateScore() {
      document.getElementById('score').innerText =
        `${playerNames[1]}ï¼š${scores[1]} å° ï½œ ${playerNames[2]}ï¼š${scores[2]} å°`;
    }

    function checkGameOver() {
      const remaining = document.querySelectorAll('.card:not(.taken)');
      if (remaining.length === 0) {
        let result = 'å¹³æ‰‹ï¼';
        if (scores[1] > scores[2]) result = playerNames[1] + ' å‹åˆ©ï¼';
        else if (scores[2] > scores[1]) result = playerNames[2] + ' å‹åˆ©ï¼';
        document.getElementById('status').innerText = result;
      }
    }
  </script>
</body>
</html>
